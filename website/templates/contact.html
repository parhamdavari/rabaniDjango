{% extends 'base.html' %}
{% load static %}
{% load i18n %}
{% block body_class %}page-contact{% endblock %}
{% block title %}{% trans 'Contact Dr. Rabbani' %} {% endblock %}
{% block meta_description %}{% trans 'Get in touch with Dr. Hossein Rabbani DDS, your trusted cosmetic dentist. Book an appointment for a smile makeover, teeth whitening, veneers, and more. Contact us today!' %} {% endblock %}
{% block content %}

    <!-- Hero Section -->
    <section class="home-slider owl-carousel">
      <div class="slider-item bread-item" style="background-image: url({% static 'website/images/hero-bg-desktop.png' %});" data-stellar-background-ratio="0.5">
        <div class="overlay"></div>
        <div class="container" data-scrollax-parent="true">
          <div class="row slider-text align-items-end">
            <div class="col-md-7 col-sm-12 ftco-animate mb-5">
              <h1 class="mb-3" data-scrollax=" properties: { translateY: '70%', opacity: .9}">{% trans 'Contact' %}</h1>
            </div>
          </div>
        </div>
      </div>
    </section>
    <!-- END Hero Section -->

    {% if message_name %}
      {% if request.session.mail_sent %}
        <!-- Error State -->
        <div class="contact-message contact-message--error">
          <div class="contact-message__icon">!</div>
          <h2 class="contact-message__title">{% trans 'Message Failed' %}</h2>
          <p class="contact-message__text">{% trans 'We have already received your message! In case of emergency, use other approaches to send us your message.' %}</p>
        </div>
      {% else %}
        <!-- Success State -->
        <div class="contact-message contact-message--success">
          <div class="contact-message__icon">&#10003;</div>
          <h2 class="contact-message__title">{% trans 'Thanks' %}, {{ message_name }}!</h2>
          <p class="contact-message__text">{% trans 'We received your email and will respond shortly' %}</p>
        </div>
      {% endif %}
    {% else %}

    <section class="contact-section" dir="{% trans 'dir' %}">
      <div class="contact-container">

        <!-- Two Column Layout -->
        <div class="contact-grid">

          <!-- Left Column: Contact Information -->
          <div class="contact-info">

            <div class="contact-info__block">
              <span class="contact-info__label">{% trans 'Address:' %}</span>
              <address class="contact-info__value">
                {% trans 'Unit 1, 8th Floor, Jaam-e-Jam Complex, East Pahlavan St., Ahvaz, Khuzestan, Iran' %}
              </address>
            </div>

            <div class="contact-info__block">
              <span class="contact-info__label">{% trans 'Phone:' %}</span>
              <a href="tel:{{dr_phone}}" class="contact-info__value contact-info__link">
                {% trans '+989033103516' %}
              </a>
            </div>

            <div class="contact-info__block">
              <span class="contact-info__label">{% trans 'Instagram' %}</span>
              <div class="contact-info__social">
                <a href="{{dr_instagram}}" class="contact-info__value contact-info__link" target="_blank" rel="noopener">
                  @dr.hossein.rabbani
                </a>
              </div>
            </div>

            <div class="contact-info__divider"></div>

            <div class="contact-info__hours">
              <span class="contact-info__label">{% trans 'Working Hours' %}</span>
              <p class="contact-info__value">
                {% trans 'Saturday - Thursday' %}<br>
                9:00 - 21:00
              </p>
            </div>

          </div>

          <!-- Right Column: Contact Form -->
          <div class="contact-form-wrapper">
            <form action="{% url 'contact' %}" method="post" class="contact-form">
              {% csrf_token %}

              <div class="contact-form__group">
                <label for="contact-name" class="contact-form__label">{% trans 'Your Name' %}</label>
                <input
                  type="text"
                  id="contact-name"
                  name="message-name"
                  class="contact-form__input"
                  placeholder="{% trans 'Full Name' %}"
                  required
                  autocomplete="name"
                >
              </div>

              <div class="contact-form__group">
                <label for="contact-phone" class="contact-form__label">{% trans 'Phone:' %}</label>
                <input
                  type="tel"
                  id="contact-phone"
                  name="message-phone"
                  class="contact-form__input"
                  placeholder="09xxxxxxxxx"
                  pattern="09[0-9]{9}"
                  maxlength="11"
                  required
                  autocomplete="tel"
                >
                <div id="contact-phone-error" class="invalid-feedback">{% trans 'Please enter a valid phone number (09xxxxxxxxx)' %}</div>
              </div>

              <div class="contact-form__group">
                <label for="contact-message" class="contact-form__label">{% trans 'Message' %}</label>
                <textarea
                  id="contact-message"
                  name="message"
                  class="contact-form__textarea"
                  placeholder="{% trans 'How can we help you?' %}"
                  rows="5"
                  required
                ></textarea>
              </div>

              <button type="submit" class="contact-form__submit">
                {% trans 'Send Message' %}
              </button>
            </form>
          </div>

        </div>

      </div>
    </section>
    {% endif %}

    <script>
      document.addEventListener('DOMContentLoaded', function() {
        const phoneField = document.getElementById('contact-phone');
        if (phoneField) {
          const phoneRegex = /^09[0-9]{9}$/;

          phoneField.addEventListener('input', function() {
            const value = phoneField.value;
            phoneField.value = value.replace(/[^0-9]/g, '');

            if (value.length > 0) {
              if (!value.startsWith('09')) {
                phoneField.classList.add('is-invalid');
                phoneField.classList.remove('is-valid');
              } else if (value.length === 11 && phoneRegex.test(value)) {
                phoneField.classList.remove('is-invalid');
                phoneField.classList.add('is-valid');
              } else if (value.length === 11) {
                phoneField.classList.add('is-invalid');
                phoneField.classList.remove('is-valid');
              } else {
                phoneField.classList.remove('is-invalid');
                phoneField.classList.remove('is-valid');
              }
            } else {
              phoneField.classList.remove('is-invalid');
              phoneField.classList.remove('is-valid');
            }
          });
        }
      });
    </script>

{% endblock %}
